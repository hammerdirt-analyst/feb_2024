

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reporting &#8212; Feb 2024</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'a_report_class';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Land use class" href="landuse_class.html" />
    <link rel="prev" title="Cumulative reports" href="cumulative_reports.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="titlepage.html">
  
  
  
  
  
    <p class="title logo__title">Feb 2024</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Models</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cumulative_land_use.html">Checking the assistant</a></li>
<li class="toctree-l1"><a class="reference internal" href="cumulative_reports.html">Cumulative reports</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="landuse_class.html">Land use class</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Annex</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="testing_data_models.html">Testing data models</a></li>
<li class="toctree-l1"><a class="reference internal" href="landuse_model_next_itteration.html">Extracting land use values</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/feb_2024" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/feb_2024/issues/new?title=Issue%20on%20page%20%2Fa_report_class.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Reporting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requests">Requests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#report-boundaries">Report boundaries</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report-contents">Report contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#report-labels">Report labels</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-report-for-a-specific-feature">Generating a report for a specific feature</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-survey-totals-between-features">Comparing survey totals between features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#most-common-objects">Most common objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#works-the-same-for-a-subreport">Works the same for a subreport</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-criteria-of-the-most-common">Changing the criteria of the most common</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-properties">Retrieving properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-tests">Unit tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-reportclass-module">The reportclass module</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-reportclass-takes-the-following-parameters">The <code class="docutils literal notranslate"><span class="pre">ReportClass</span></code> takes the following parameters:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#and-has-the-following-methods">And has the following methods:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-methods-in-the-reportclass-module">Other methods in the <code class="docutils literal notranslate"><span class="pre">reportclass</span></code> module.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-codes-using-parent-groups">Combining codes using parent groups</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-to-beach-litter-data">Specific to beach litter data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-a-dataframe">Aggregate a dataframe</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#config-settings">config settings</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-rate-per-unit">Calculating rate per unit</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">config settings</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-boundaries">Aggregate boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-reports">Cumulative reports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorize-work-data">Categorize work data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-a-vector">Summarize a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-records-by-value">Collecting records by value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-occurences">Counting occurences</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-by-two-criteria">Selecting by two criteria</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># from review_methods_tests import collect_vitals, find_missing, find_missing_loc_dates</span>
<span class="c1"># from review_methods_tests import make_a_summary</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span><span class="p">,</span> <span class="n">ListedColormap</span>

<span class="kn">import</span> <span class="nn">setvariables</span> <span class="k">as</span> <span class="nn">conf_</span>
<span class="kn">import</span> <span class="nn">reportclass</span> <span class="k">as</span> <span class="nn">r_class</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="reporting">
<span id="id1"></span><h1>Reporting<a class="headerlink" href="#reporting" title="Permalink to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">Report</span></code> class is used to generate descriptive statistics and identify objects of interest from a query defined by geographic, adminsitrative and/or temporal bounds. These results are considered in the context of topographic data using the <code class="docutils literal notranslate"><span class="pre">LandUse</span></code> class.</p>
<div class="section" id="requests">
<h2>Requests<a class="headerlink" href="#requests" title="Permalink to this heading">#</a></h2>
<p>A request has five components including the data.  A dictionary that contains four key-value pairs, one of which must be column name and value for that column, start and end dates  and language choice. The <code class="docutils literal notranslate"><span class="pre">report_data</span></code> method uses the request to slice the data and load detailed information for survey locations and objects. The results of <code class="docutils literal notranslate"><span class="pre">report_data</span></code> are passed on to the <code class="docutils literal notranslate"><span class="pre">ReportClass</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># example one</span>
<span class="c1"># this will give a report on the canton of bern in french between the specified dates</span>
<span class="n">boundaries</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">canton</span><span class="o">=</span><span class="s1">&#39;Bern&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-12-31&quot;</span><span class="p">)</span>

<span class="c1"># example two</span>
<span class="c1"># this will give a report on all lakes</span>
<span class="n">boundaries</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">feature_type</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s1">&#39;2019-01-01&#39;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">)</span>

<span class="c1"># the report_data method takes the boundaries and returns returns the top level of the report</span>
<span class="c1"># the language and two data frames from the same date range. w_df includes only the surveys</span>
<span class="c1"># that meet the criteria in boundaries, w_di includes all the data from the date range.</span>
<span class="n">top_label</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">w_df</span><span class="p">,</span> <span class="n">w_di</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">report_data</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">survey_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">beaches</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

<span class="c1"># the language map is included with the module</span>
<span class="n">a_report</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">ReportClass</span><span class="p">(</span><span class="n">w_df</span><span class="p">,</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">top_label</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">language_map</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="report-boundaries">
<h3>Report boundaries<a class="headerlink" href="#report-boundaries" title="Permalink to this heading">#</a></h3>
<p>Once the boundaries have been applied to the survey data the basic report contents can be summarized. Calling <code class="docutils literal notranslate"><span class="pre">a_report.available_features</span></code> lists the identified geographic/adminstrative boundaries within the report data. If the boundaries are set to<code class="docutils literal notranslate"><span class="pre">canton='Bern'</span></code> there are four reporting categories available</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># a summary of the different features and boundaries in a report</span>
<span class="n">a_report</span><span class="o">.</span><span class="n">available_features</span>

<span class="c1"># the number of each type of feature within the selected data</span>
<span class="n">a_report</span><span class="o">.</span><span class="n">the_number_of_attributes_in_a_feature</span><span class="p">(</span><span class="s1">&#39;feature_type&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># starting data, can be MySQL or NoSQL calls</span>
<span class="c1"># the three methods accept Callables, as long</span>
<span class="c1"># as the out put is pd.DataFrame</span>
<span class="n">c_l</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">language_maps</span><span class="p">()</span>
<span class="n">surveys</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">collect_survey_data_for_report</span><span class="p">()</span>
<span class="n">codes</span><span class="p">,</span> <span class="n">beaches</span><span class="p">,</span> <span class="n">land_cover</span><span class="p">,</span> <span class="n">land_use</span><span class="p">,</span> <span class="n">streets</span><span class="p">,</span> <span class="n">river_intersect_lakes</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">collect_env_data_for_report</span><span class="p">()</span>

<span class="n">survey_data</span> <span class="o">=</span> <span class="n">surveys</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">beaches</span><span class="p">[</span><span class="s1">&#39;canton&#39;</span><span class="p">],</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="s1">&#39;many_to_one&#39;</span><span class="p">)</span>

<span class="c1"># temporal and geographic boundaries</span>
<span class="c1"># user defined input</span>
<span class="n">boundaries</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">canton</span><span class="o">=</span><span class="s1">&#39;Bern&#39;</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2015-11-01&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="s2">&quot;2021-12-31&quot;</span><span class="p">)</span>

<span class="c1"># the report_data method takes the boundaries and returns returns the top level of the report</span>
<span class="c1"># the language and two data frames from the same date range. w_df includes only the surveys</span>
<span class="c1"># that meet the criteria in boundaries, w_di includes all the data from the date range.</span>
<span class="n">top_label</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">w_df</span><span class="p">,</span> <span class="n">w_di</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">report_data</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">survey_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">beaches</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

<span class="c1"># the language map is included with the module</span>
<span class="n">a_report</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">ReportClass</span><span class="p">(</span><span class="n">w_df</span><span class="p">,</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">top_label</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">c_l</span><span class="p">)</span>

<span class="c1"># a summary of the different features and boundaries in a report</span>
<span class="n">a_report</span><span class="o">.</span><span class="n">available_features</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;parent_boundary&#39;, &#39;feature_type&#39;, &#39;feature_name&#39;, &#39;city&#39;]
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The available features are column names of the survey data. They represent the different geopraphic or administrative boundaries in the selected report data.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">parent_boundary</span></code> is a geographic boundary such as a river basin or a category such as mountains</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_type</span></code> designates whether the location is at a river, lake or park</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feature_name</span></code> is the name of the river, lake or park</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="report-contents">
<h2>Report contents<a class="headerlink" href="#report-contents" title="Permalink to this heading">#</a></h2>
<p>Within the canton of Bern there are samples from one park, four lakes and six rivers. The lakes have the most samples, followed by rivers and parks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the number and category of samples from the different features in the report</span>
<span class="n">a_report</span><span class="o">.</span><span class="n">the_number_of_attributes_in_a_feature</span><span class="p">(</span><span class="s1">&#39;feature_type&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>feature_name</th>
      <th>samples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>r</th>
      <td>14</td>
      <td>6</td>
      <td>96</td>
    </tr>
    <tr>
      <th>l</th>
      <td>14</td>
      <td>4</td>
      <td>99</td>
    </tr>
    <tr>
      <th>p</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="report-labels">
<h3>Report labels<a class="headerlink" href="#report-labels" title="Permalink to this heading">#</a></h3>
<p>The surveys are categorized by parks, lakes or rivers. The name of each one and the municipalities where surveys were conducted can be accesed with <code class="docutils literal notranslate"><span class="pre">Report.feature_labels()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_labels</span> <span class="o">=</span> <span class="n">a_report</span><span class="o">.</span><span class="n">feature_labels</span><span class="p">()</span>
</pre></div>
</div>
<p>The subject of the report can be identified by calling <code class="docutils literal notranslate"><span class="pre">a_report.top_label</span></code>. The first element is a column name in the dataframe and the second element is the value of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a_report</span><span class="o">.</span><span class="n">top_label</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;canton&#39;, &#39;Bern&#39;]
</pre></div>
</div>
</div>
</div>
<p>To identify the municipalities associated with a particular feature in the report simply use the feature labels as a key to <code class="docutils literal notranslate"><span class="pre">my_labels</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># collect the labels</span>
<span class="n">my_labels</span> <span class="o">=</span> <span class="n">a_report</span><span class="o">.</span><span class="n">feature_labels</span><span class="p">()</span>
<span class="c1"># the lakes and the cities on those lakes</span>
<span class="n">my_labels</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;feature_name&#39;: array([&#39;aare&#39;, &#39;bielersee&#39;, &#39;brienzersee&#39;, &#39;thunersee&#39;], dtype=object),
 &#39;city&#39;: array([&#39;Kallnach&#39;, &#39;Vinelz&#39;, &#39;Erlach&#39;, &#39;Gals&#39;, &#39;Ligerz&#39;, &#39;Lüscherz&#39;,
        &#39;Biel/Bienne&#39;, &#39;Nidau&#39;, &#39;Bönigen&#39;, &#39;Brienz (BE)&#39;, &#39;Spiez&#39;, &#39;Thun&#39;,
        &#39;Beatenberg&#39;, &#39;Unterseen&#39;], dtype=object)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># in the same way the name of the parks and the cities in those parks can be indentified</span>
<span class="n">my_labels</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;feature_name&#39;: array([&#39;alpes-bernoises&#39;], dtype=object),
 &#39;city&#39;: array([&#39;Grindelwald&#39;], dtype=object)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the same for rivers</span>
<span class="n">my_labels</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;feature_name&#39;: array([&#39;aare&#39;, &#39;aarenidau-buren-kanal&#39;, &#39;emme&#39;, &#39;langeten&#39;, &#39;schuss&#39;,
        &#39;zulg&#39;], dtype=object),
 &#39;city&#39;: array([&#39;Muri bei Bern&#39;, &#39;Bern&#39;, &#39;Belp&#39;, &#39;Köniz&#39;, &#39;Walperswil&#39;, &#39;Kallnach&#39;,
        &#39;Rubigen&#39;, &#39;Port&#39;, &#39;Brügg&#39;, &#39;Utzenstorf&#39;, &#39;Burgdorf&#39;, &#39;Langenthal&#39;,
        &#39;Biel/Bienne&#39;, &#39;Steffisburg&#39;], dtype=object)}
</pre></div>
</div>
</div>
</div>
<div class="section" id="generating-a-report-for-a-specific-feature">
<h4>Generating a report for a specific feature<a class="headerlink" href="#generating-a-report-for-a-specific-feature" title="Permalink to this heading">#</a></h4>
<p>A detailed report can be generated for any element in the feature labels. The method <code class="docutils literal notranslate"><span class="pre">ReportClass.a_subreport(feature_of_interest='my_feature')</span></code> accepts the name of the feauture of interest and uses the data from the established report to create a report that contains only the data from the feature of interest.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bielersee</span> <span class="o">=</span> <span class="n">a_report</span><span class="o">.</span><span class="n">a_subreport</span><span class="p">(</span><span class="n">feature_of_interest</span><span class="o">=</span><span class="s1">&#39;bielersee&#39;</span><span class="p">)</span>
<span class="n">bielersee</span><span class="o">.</span><span class="n">feature_labels</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;l&#39;: {&#39;feature_name&#39;: array([&#39;bielersee&#39;], dtype=object),
  &#39;city&#39;: array([&#39;Vinelz&#39;, &#39;Erlach&#39;, &#39;Gals&#39;, &#39;Ligerz&#39;, &#39;Lüscherz&#39;, &#39;Biel/Bienne&#39;,
         &#39;Nidau&#39;], dtype=object)}}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="comparing-survey-totals-between-features">
<h3>Comparing survey totals between features<a class="headerlink" href="#comparing-survey-totals-between-features" title="Permalink to this heading">#</a></h3>
<p>The survey totals are the sum of all the objects found at a survey divided by the length of the survey. Comparing the survey results between features in a report is done by calling <code class="docutils literal notranslate"><span class="pre">ReportClass.summarize_feature_labels(feature='feature</span> <span class="pre">of</span> <span class="pre">interest')</span></code> for example to compare the survey totals between cities in Bern call <code class="docutils literal notranslate"><span class="pre">a_report.summarize_feature_labels(feature='city')</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a_report</span><span class="o">.</span><span class="n">summarize_feature_labels</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="s1">&#39;city&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="21" halign="left">pcs_m</th>
    </tr>
    <tr>
      <th>label</th>
      <th>Beatenberg</th>
      <th>Belp</th>
      <th>Bern</th>
      <th>Biel/Bienne</th>
      <th>Brienz (BE)</th>
      <th>Brügg</th>
      <th>Burgdorf</th>
      <th>Bönigen</th>
      <th>Erlach</th>
      <th>Gals</th>
      <th>...</th>
      <th>Nidau</th>
      <th>Port</th>
      <th>Rubigen</th>
      <th>Spiez</th>
      <th>Steffisburg</th>
      <th>Thun</th>
      <th>Unterseen</th>
      <th>Utzenstorf</th>
      <th>Vinelz</th>
      <th>Walperswil</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25%</th>
      <td>1.9875</td>
      <td>0.05</td>
      <td>0.19</td>
      <td>2.69</td>
      <td>4.14</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.0925</td>
      <td>1.83</td>
      <td>1.215</td>
      <td>...</td>
      <td>2.52</td>
      <td>0.8125</td>
      <td>3.2</td>
      <td>0.3725</td>
      <td>0.18</td>
      <td>1.24</td>
      <td>1.095</td>
      <td>0.4125</td>
      <td>2.14</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.425</td>
      <td>0.1</td>
      <td>0.525</td>
      <td>5.06</td>
      <td>5.02</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.175</td>
      <td>1.83</td>
      <td>1.28</td>
      <td>...</td>
      <td>2.52</td>
      <td>1.375</td>
      <td>3.2</td>
      <td>0.595</td>
      <td>0.24</td>
      <td>1.39</td>
      <td>1.8</td>
      <td>0.495</td>
      <td>3.38</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.8625</td>
      <td>0.17</td>
      <td>1.2675</td>
      <td>7.5</td>
      <td>5.1</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.2575</td>
      <td>1.83</td>
      <td>1.345</td>
      <td>...</td>
      <td>2.52</td>
      <td>1.9375</td>
      <td>3.2</td>
      <td>0.9825</td>
      <td>0.545</td>
      <td>1.555</td>
      <td>2.3025</td>
      <td>0.66</td>
      <td>5.215</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>count</th>
      <td>2</td>
      <td>11</td>
      <td>32</td>
      <td>17</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>26</td>
      <td>11</td>
      <td>3</td>
      <td>12</td>
      <td>8</td>
      <td>23</td>
      <td>1</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.3</td>
      <td>0.19</td>
      <td>5.42</td>
      <td>9.68</td>
      <td>5.18</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.34</td>
      <td>1.83</td>
      <td>1.41</td>
      <td>...</td>
      <td>2.52</td>
      <td>2.5</td>
      <td>3.2</td>
      <td>2.84</td>
      <td>3.58</td>
      <td>1.72</td>
      <td>3.94</td>
      <td>1.22</td>
      <td>10.47</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.425</td>
      <td>0.111818</td>
      <td>1.022187</td>
      <td>5.074706</td>
      <td>4.486667</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.175</td>
      <td>1.83</td>
      <td>1.28</td>
      <td>...</td>
      <td>2.52</td>
      <td>1.375</td>
      <td>3.2</td>
      <td>0.786923</td>
      <td>0.634545</td>
      <td>1.4</td>
      <td>1.888333</td>
      <td>0.565</td>
      <td>3.770435</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.55</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>0.91</td>
      <td>3.26</td>
      <td>1.02</td>
      <td>0.87</td>
      <td>3.01</td>
      <td>1.83</td>
      <td>1.15</td>
      <td>...</td>
      <td>2.52</td>
      <td>0.25</td>
      <td>3.2</td>
      <td>0.16</td>
      <td>0.06</td>
      <td>1.09</td>
      <td>0.54</td>
      <td>0.22</td>
      <td>1.05</td>
      <td>0.22</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.237437</td>
      <td>0.065087</td>
      <td>1.266312</td>
      <td>2.911849</td>
      <td>1.065332</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.233345</td>
      <td>NaN</td>
      <td>0.183848</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.59099</td>
      <td>NaN</td>
      <td>0.612306</td>
      <td>1.010202</td>
      <td>0.315119</td>
      <td>1.044595</td>
      <td>0.30538</td>
      <td>2.24379</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>total</th>
      <td>104</td>
      <td>60</td>
      <td>1892</td>
      <td>3307</td>
      <td>696</td>
      <td>36</td>
      <td>41</td>
      <td>277</td>
      <td>101</td>
      <td>48</td>
      <td>...</td>
      <td>63</td>
      <td>118</td>
      <td>57</td>
      <td>838</td>
      <td>114</td>
      <td>276</td>
      <td>1879</td>
      <td>41</td>
      <td>2033</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
<p>9 rows × 27 columns</p>
</div></div></div>
</div>
<p><strong>Any available feature or category of the report can be called</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a_report</span><span class="o">.</span><span class="n">summarize_feature_labels</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="s1">&#39;feature_type&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The distribution of survey totals in parks, rivers and lakes for the canton:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">pcs_m</th>
    </tr>
    <tr>
      <th>label</th>
      <th>l</th>
      <th>p</th>
      <th>r</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25%</th>
      <td>0.89</td>
      <td>2.81</td>
      <td>0.1975</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.83</td>
      <td>2.81</td>
      <td>0.73</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.62</td>
      <td>2.81</td>
      <td>1.5925</td>
    </tr>
    <tr>
      <th>count</th>
      <td>99</td>
      <td>1</td>
      <td>96</td>
    </tr>
    <tr>
      <th>max</th>
      <td>14.8</td>
      <td>2.81</td>
      <td>7.92</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.796061</td>
      <td>2.81</td>
      <td>1.209167</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.16</td>
      <td>2.81</td>
      <td>0.02</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.637667</td>
      <td>NaN</td>
      <td>1.464487</td>
    </tr>
    <tr>
      <th>total</th>
      <td>9902</td>
      <td>169</td>
      <td>3688</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>The subreport for a specific feature works exactly the same way:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bielersee</span><span class="o">.</span><span class="n">summarize_feature_labels</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="s1">&#39;city&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The distritbution of survey totals for the cities on bielersee:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="7" halign="left">pcs_m</th>
    </tr>
    <tr>
      <th>label</th>
      <th>Biel/Bienne</th>
      <th>Erlach</th>
      <th>Gals</th>
      <th>Ligerz</th>
      <th>Lüscherz</th>
      <th>Nidau</th>
      <th>Vinelz</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25%</th>
      <td>3.725</td>
      <td>1.83</td>
      <td>1.215</td>
      <td>3.7</td>
      <td>0.43</td>
      <td>2.52</td>
      <td>2.14</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.42</td>
      <td>1.83</td>
      <td>1.28</td>
      <td>4.0</td>
      <td>0.64</td>
      <td>2.52</td>
      <td>3.38</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.76</td>
      <td>1.83</td>
      <td>1.345</td>
      <td>9.4</td>
      <td>0.84</td>
      <td>2.52</td>
      <td>5.215</td>
    </tr>
    <tr>
      <th>count</th>
      <td>15</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>5</td>
      <td>1</td>
      <td>23</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.68</td>
      <td>1.83</td>
      <td>1.41</td>
      <td>14.8</td>
      <td>1.42</td>
      <td>2.52</td>
      <td>10.47</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.613333</td>
      <td>1.83</td>
      <td>1.28</td>
      <td>7.4</td>
      <td>0.746</td>
      <td>2.52</td>
      <td>3.770435</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.91</td>
      <td>1.83</td>
      <td>1.15</td>
      <td>3.4</td>
      <td>0.4</td>
      <td>2.52</td>
      <td>1.05</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.654795</td>
      <td>NaN</td>
      <td>0.183848</td>
      <td>6.415606</td>
      <td>0.416509</td>
      <td>NaN</td>
      <td>2.24379</td>
    </tr>
    <tr>
      <th>total</th>
      <td>3209</td>
      <td>101</td>
      <td>48</td>
      <td>163</td>
      <td>202</td>
      <td>63</td>
      <td>2033</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="most-common-objects">
<h3>Most common objects<a class="headerlink" href="#most-common-objects" title="Permalink to this heading">#</a></h3>
<p>The most common objects in a report are selected using two criteria:</p>
<ul class="simple">
<li><p>The ranking by quantity ie. top-ten, top-twenty</p></li>
<li><p>The fail rate: ie. 0.5, 0,6</p></li>
</ul>
<p>The defaults are set in the <code class="docutils literal notranslate"><span class="pre">ReportClass</span></code>, however they can be changed by providing values for the variables <code class="docutils literal notranslate"><span class="pre">mc_criteria_one</span></code> and <code class="docutils literal notranslate"><span class="pre">mc_criteria_two</span></code> when the report is created. Once the variables are set the most common objects are displayed with the quantity, percent of total, the median pcs/m and the fail rate for each object in the most common. The weight of the most common objects with respect to the all the objects is also included.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">most_common</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">a_report</span><span class="o">.</span><span class="n">most_common</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>quantity</th>
      <th>%</th>
      <th>pcs_m</th>
      <th>fail rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>G27</th>
      <td>2410</td>
      <td>0.175158</td>
      <td>0.07</td>
      <td>0.739796</td>
    </tr>
    <tr>
      <th>Gfrags</th>
      <td>1870</td>
      <td>0.135911</td>
      <td>0.01</td>
      <td>0.698980</td>
    </tr>
    <tr>
      <th>G67</th>
      <td>1172</td>
      <td>0.085181</td>
      <td>0.03</td>
      <td>0.586735</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>750</td>
      <td>0.054510</td>
      <td>0.04</td>
      <td>0.637755</td>
    </tr>
    <tr>
      <th>Gfoams</th>
      <td>542</td>
      <td>0.039392</td>
      <td>0.00</td>
      <td>0.423469</td>
    </tr>
    <tr>
      <th>G145</th>
      <td>461</td>
      <td>0.033505</td>
      <td>0.00</td>
      <td>0.153061</td>
    </tr>
    <tr>
      <th>G200</th>
      <td>362</td>
      <td>0.026310</td>
      <td>0.00</td>
      <td>0.331633</td>
    </tr>
    <tr>
      <th>G208</th>
      <td>342</td>
      <td>0.024856</td>
      <td>0.00</td>
      <td>0.316327</td>
    </tr>
    <tr>
      <th>Gcaps</th>
      <td>285</td>
      <td>0.020714</td>
      <td>0.00</td>
      <td>0.408163</td>
    </tr>
    <tr>
      <th>G941</th>
      <td>261</td>
      <td>0.018969</td>
      <td>0.00</td>
      <td>0.224490</td>
    </tr>
    <tr>
      <th>G74</th>
      <td>242</td>
      <td>0.017588</td>
      <td>0.00</td>
      <td>0.239796</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;quantity&#39;: 8697.0, &#39;%&#39;: 0.6320953557671344}
</pre></div>
</div>
</div>
</div>
<div class="section" id="works-the-same-for-a-subreport">
<h4>Works the same for a subreport<a class="headerlink" href="#works-the-same-for-a-subreport" title="Permalink to this heading">#</a></h4>
<p>The criteria for selecting the most common in a subreport are by default the same as the original report.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b_most_common</span><span class="p">,</span> <span class="n">b_weight</span> <span class="o">=</span> <span class="n">bielersee</span><span class="o">.</span><span class="n">most_common</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>quantity</th>
      <th>%</th>
      <th>pcs_m</th>
      <th>fail rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Gfrags</th>
      <td>1089</td>
      <td>0.187146</td>
      <td>0.12</td>
      <td>0.98</td>
    </tr>
    <tr>
      <th>G27</th>
      <td>841</td>
      <td>0.144527</td>
      <td>0.06</td>
      <td>0.80</td>
    </tr>
    <tr>
      <th>G67</th>
      <td>697</td>
      <td>0.119780</td>
      <td>0.30</td>
      <td>0.92</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>363</td>
      <td>0.062382</td>
      <td>0.16</td>
      <td>0.84</td>
    </tr>
    <tr>
      <th>Gfoams</th>
      <td>208</td>
      <td>0.035745</td>
      <td>0.00</td>
      <td>0.64</td>
    </tr>
    <tr>
      <th>G200</th>
      <td>179</td>
      <td>0.030761</td>
      <td>0.02</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>G941</th>
      <td>166</td>
      <td>0.028527</td>
      <td>0.00</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>Gcaps</th>
      <td>140</td>
      <td>0.024059</td>
      <td>0.00</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>G25</th>
      <td>98</td>
      <td>0.016841</td>
      <td>0.03</td>
      <td>0.66</td>
    </tr>
    <tr>
      <th>G89</th>
      <td>95</td>
      <td>0.016326</td>
      <td>0.02</td>
      <td>0.56</td>
    </tr>
    <tr>
      <th>G940</th>
      <td>92</td>
      <td>0.015810</td>
      <td>0.00</td>
      <td>0.24</td>
    </tr>
    <tr>
      <th>G177</th>
      <td>77</td>
      <td>0.013233</td>
      <td>0.03</td>
      <td>0.62</td>
    </tr>
    <tr>
      <th>G904</th>
      <td>75</td>
      <td>0.012889</td>
      <td>0.02</td>
      <td>0.52</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="changing-the-criteria-of-the-most-common">
<h4>Changing the criteria of the most common<a class="headerlink" href="#changing-the-criteria-of-the-most-common" title="Permalink to this heading">#</a></h4>
<p>Specify the new values for the criteria and call a new report. In the example below the criteria are changed to the top-five objects or those objects that were found in at least 60% of the surveys.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># default arguments that define the most common objects</span>
<span class="c1"># this assumes that the columns quantity and fail rate exist</span>
<span class="n">mc_criteria_one</span> <span class="o">=</span> <span class="p">{</span>
        
        <span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;quantity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mi">5</span>
    <span class="p">}</span>

<span class="n">mc_criteria_two</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;fail rate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mf">0.6</span>
    <span class="p">}</span>
<span class="n">a_report_changed</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">ReportClass</span><span class="p">(</span><span class="n">w_df</span><span class="p">,</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">top_label</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">c_l</span><span class="p">,</span> <span class="n">mc_criteria_one</span><span class="o">=</span><span class="n">mc_criteria_one</span><span class="p">,</span> <span class="n">mc_criteria_two</span><span class="o">=</span><span class="n">mc_criteria_two</span><span class="p">)</span>
<span class="n">c_mc</span><span class="p">,</span> <span class="n">weight_cmc</span> <span class="o">=</span> <span class="n">a_report_changed</span><span class="o">.</span><span class="n">most_common</span>
<span class="n">c_mc</span>
</pre></div>
</div>
<p>Note the only variables that changed are the selection criteria. The new most common objects list for the canton is shorter and accounts for less of the total.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>quantity</th>
      <th>%</th>
      <th>pcs_m</th>
      <th>fail rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>G27</th>
      <td>2410</td>
      <td>0.175158</td>
      <td>0.07</td>
      <td>0.739796</td>
    </tr>
    <tr>
      <th>Gfrags</th>
      <td>1870</td>
      <td>0.135911</td>
      <td>0.01</td>
      <td>0.698980</td>
    </tr>
    <tr>
      <th>G67</th>
      <td>1172</td>
      <td>0.085181</td>
      <td>0.03</td>
      <td>0.586735</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>750</td>
      <td>0.054510</td>
      <td>0.04</td>
      <td>0.637755</td>
    </tr>
    <tr>
      <th>Gfoams</th>
      <td>542</td>
      <td>0.039392</td>
      <td>0.00</td>
      <td>0.423469</td>
    </tr>
    <tr>
      <th>G145</th>
      <td>461</td>
      <td>0.033505</td>
      <td>0.00</td>
      <td>0.153061</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight_cmc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;quantity&#39;: 7205.0, &#39;%&#39;: 0.5236572425321608}
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="retrieving-properties">
<h2>Retrieving properties<a class="headerlink" href="#retrieving-properties" title="Permalink to this heading">#</a></h2>
<p>There are 318’478 rows in the survey data. We can test the sorting and grouping functions by running a report class on all possible combinations of the features of interest. The test should produce the set of arguments that define the survey locations and surveys that define the boundaries of a report.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">some_features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;feature_type&#39;</span><span class="p">,</span> <span class="s1">&#39;parent_boundary&#39;</span><span class="p">,</span> <span class="s1">&#39;feature_name&#39;</span><span class="p">,</span> <span class="s1">&#39;canton&#39;</span><span class="p">,</span> <span class="s1">&#39;city&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">produce_reports_for_testing</span><span class="p">(</span><span class="n">survey_data</span><span class="p">,</span> <span class="n">some_features</span><span class="p">):</span>
    <span class="n">reports</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">a_feature</span> <span class="ow">in</span> <span class="n">some_features</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">survey_data</span><span class="p">[</span><span class="n">a_feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">label_reports</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">survey_data</span><span class="p">[</span><span class="n">survey_data</span><span class="p">[</span><span class="n">a_feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">][</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">survey_data</span><span class="p">[</span><span class="n">survey_data</span><span class="p">[</span><span class="n">a_feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">][</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            
            <span class="n">boundaries</span> <span class="o">=</span> <span class="p">{</span><span class="n">a_feature</span><span class="p">:</span><span class="n">label</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">:</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="s1">&#39;start_date&#39;</span><span class="p">:</span><span class="n">start_date</span><span class="p">,</span> <span class="s1">&#39;end_date&#39;</span><span class="p">:</span><span class="n">end_date</span><span class="p">}</span>
            <span class="n">top_label</span><span class="p">,</span> <span class="n">language</span><span class="p">,</span> <span class="n">w_df</span><span class="p">,</span> <span class="n">w_di</span> <span class="o">=</span> <span class="n">report_data</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">survey_data</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
            <span class="n">a_report</span> <span class="o">=</span> <span class="n">ReportClass</span><span class="p">(</span><span class="n">w_df</span><span class="p">,</span> <span class="n">w_di</span><span class="p">,</span> <span class="n">boundaries</span><span class="p">,</span> <span class="n">top_label</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="n">c_l</span><span class="p">)</span>
            <span class="n">label_reports</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">label</span><span class="p">:</span><span class="n">a_report</span><span class="o">.</span><span class="n">features</span><span class="p">})</span>
        <span class="n">reports</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">a_feature</span><span class="p">:</span><span class="n">label_reports</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">reports</span>
   
<span class="n">t</span> <span class="o">=</span> <span class="n">produce_reports_for_testing</span><span class="p">(</span><span class="n">survey_data</span><span class="p">,</span> <span class="n">some_features</span><span class="p">)</span>

<span class="n">t</span><span class="p">[</span><span class="s1">&#39;canton&#39;</span><span class="p">][</span><span class="s1">&#39;Valais&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<p>The properties should contain the arguments for cities in the example report</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># t[&#39;city&#39;][&#39;Saint-Gingolph&#39;]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unit-tests">
<h2>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this heading">#</a></h2>
<div class="section" id="the-reportclass-module">
<h3>The reportclass module<a class="headerlink" href="#the-reportclass-module" title="Permalink to this heading">#</a></h3>
<div class="section" id="the-reportclass-takes-the-following-parameters">
<h4>The <code class="docutils literal notranslate"><span class="pre">ReportClass</span></code> takes the following parameters:<a class="headerlink" href="#the-reportclass-takes-the-following-parameters" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>w_df (pd.DataFrame, optional): The survey data DataFrame for report generation.</p></li>
<li><p>boundaries (dict, optional): A dictionary defining the reporting boundaries, including ‘start_date’, end_date’, and ‘language’.</p></li>
<li><p>top_label (List, optional): A list containing two elements - [label_column, label_value].</p></li>
<li><p>language (str, optional): The language in which the report is generated.</p></li>
<li><p>lang_maps (pd.DataFrame, optional): A DataFrame containing language mapping data.</p></li>
<li><p>mc_criteria_one (dict, optional): The first criteria for identifying objects of interest.</p></li>
<li><p>mc_criteria_two (dict, optional): The second criteria for identifying objects of interest.</p></li>
<li><p>ooi (str, optional): The name of the object of interest column.</p></li>
</ul>
</div>
<div class="section" id="and-has-the-following-methods">
<h4>And has the following methods:<a class="headerlink" href="#and-has-the-following-methods" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>features: Get a list of available features for report generation.</p></li>
<li><p>available_features: Get a list of available features based on predefined criteria.</p></li>
<li><p>inventory: Get an inventory of objects with summary statistics.</p></li>
<li><p>most_common: Find the most common objects based on criteria.</p></li>
<li><p>summarize_feature_labels: Summarize data for a specific feature.</p></li>
<li><p>the_number_of_attributes_in_a_feature: Count attributes in a feature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__repr__</span></code> : Return a string representation of the ReportClass instance.</p></li>
</ul>
</div>
<div class="section" id="other-methods-in-the-reportclass-module">
<h4>Other methods in the <code class="docutils literal notranslate"><span class="pre">reportclass</span></code> module.<a class="headerlink" href="#other-methods-in-the-reportclass-module" title="Permalink to this heading">#</a></h4>
<p>Note: <strong>the methods in bold have been unit tested</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">getmembers</span><span class="p">,</span> <span class="n">isfunction</span>

<span class="n">functions_list</span> <span class="o">=</span> <span class="n">getmembers</span><span class="p">(</span><span class="n">reportclass</span><span class="p">,</span> <span class="n">isfunction</span><span class="p">)</span>
<span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">functions_list</span><span class="p">]</span>

</pre></div>
</div>
<p>AGGREGATING, COUNTING, REPORTING:</p>
<ul class="simple">
<li><p><strong>‘a_cumulative_report’</strong>,</p></li>
<li><p><strong>‘a_summary_of_one_vector’</strong>,</p></li>
<li><p><strong>‘aggregate_boundaries’</strong>,</p></li>
<li><p><strong>‘aggregate_dataframe’</strong>,</p></li>
<li><p><strong>‘calculate_rate_per_unit’</strong>,</p></li>
<li><p><strong>‘use_gfrags_gfoams_gcaps’</strong>,</p></li>
<li><p><strong>‘use_parent_groups_or_gfrags</strong>’</p></li>
<li><p><strong>‘categorize_work_data’</strong>,</p></li>
<li><p><strong>‘count_objects_with_positive_quantity’</strong>,</p></li>
<li><p><strong>‘display_tabular_data_by_column_values’</strong>,</p></li>
<li><p><strong>‘get_top_x_records_with_max_quantity’</strong>,</p></li>
</ul>
<p>COLLECTING DATA</p>
<ul class="simple">
<li><p>‘collect_env_data_for_report’,</p></li>
<li><p>‘collect_survey_data_for_report’,</p></li>
<li><p>‘combine_survey_files’,</p></li>
<li><p>‘report_data’,</p></li>
<li><p>‘slice_data_by_date’,</p></li>
</ul>
<p>PROCESSING DATA WITH REQUEST</p>
<ul class="simple">
<li><p>‘check_for_top_label’,</p></li>
<li><p>‘merge_dataframes_on_column_and_index’,</p></li>
<li><p>‘add_column_to_work_data’,</p></li>
<li><p>‘add_columns_to_work_data’,</p></li>
</ul>
<p>DISPLAY</p>
<ul class="simple">
<li><p>‘language_maps’,</p></li>
<li><p>‘translate_for_display’,</p></li>
<li><p>‘capitalize_index’,</p></li>
<li><p>‘translate_word’,</p></li>
<li><p>‘translated_and_style_for_display’,</p></li>
<li><p>‘color_gradient’,</p></li>
</ul>
</div>
</div>
<div class="section" id="combining-codes-using-parent-groups">
<h3>Combining codes using parent groups<a class="headerlink" href="#combining-codes-using-parent-groups" title="Permalink to this heading">#</a></h3>
<div class="section" id="specific-to-beach-litter-data">
<h4>Specific to beach litter data<a class="headerlink" href="#specific-to-beach-litter-data" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.use_parent_groups_or_gfrags</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.use_gfrags_gfoams_gcaps</span></code></p></li>
</ul>
<p>config setting: <code class="docutils literal notranslate"><span class="pre">setvariables.code_result_columns</span></code></p>
<blockquote>
<div><p>Defines the set of columns to use when aggregating to the object level</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unittest</span>
<span class="k">class</span> <span class="nc">TestUseGfragsGfoamsGcaps</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_use_gfrags_gfoams_gcaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data and code mappings</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;parent_code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="s1">&#39;Gfrags&#39;</span><span class="p">,</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span><span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]})</span>
        <span class="n">codes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Gfrags&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span>  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span>  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;F&#39;</span><span class="p">},</span>
             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
        <span class="p">)</span>

        <span class="c1"># Call the function</span>
        <span class="n">updated_data</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">use_gfrags_gfoams_gcaps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">updated_data</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestUseGfragsGfoamsGcaps</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unittest</span>
<span class="k">class</span> <span class="nc">TestUseGfragsGfoamsGcaps</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_use_gfrags_gfoams_gcaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data and code mappings</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;parent_code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="s1">&#39;Gfrags&#39;</span><span class="p">,</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span><span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]})</span>
        <span class="n">codes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Gfrags&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Gfoams&#39;</span><span class="p">,</span>  <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Gcaps&#39;</span><span class="p">,</span>  <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;F&#39;</span><span class="p">},</span>
             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">},</span>
             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
        <span class="p">)</span>

        <span class="c1"># Call the function</span>
        <span class="n">updated_data</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">use_gfrags_gfoams_gcaps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">updated_data</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestUseGfragsGfoamsGcaps</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_use_gfrags_gfoams_gcaps (__main__.TestUseGfragsGfoamsGcaps) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.006s

OK
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aggregate-a-dataframe">
<h3>Aggregate a dataframe<a class="headerlink" href="#aggregate-a-dataframe" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.aggregate_dataframe</span></code></p></li>
</ul>
<div class="section" id="config-settings">
<h4>config settings<a class="headerlink" href="#config-settings" title="Permalink to this heading">#</a></h4>
<p>Accepts the following arguments for the methods given the defaults <code class="docutils literal notranslate"><span class="pre">code_result_columns</span></code> and <code class="docutils literal notranslate"><span class="pre">work_columns</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setvariables.agg_groups</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setvariables.unit_agg</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestAggregateDataFrame</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_aggregate_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;prop a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;prop b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span> <span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">]})</span>
        <span class="n">group_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span><span class="s1">&#39;prop a&#39;</span><span class="p">]</span>
        <span class="n">aggregation_functions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="s1">&#39;prop a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;s2&#39;</span><span class="p">},</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}})</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groupby_columns</span><span class="o">=</span><span class="n">group_by_columns</span><span class="p">,</span> <span class="n">aggregation_functions</span><span class="o">=</span><span class="n">aggregation_functions</span><span class="p">)</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestAggregateDataFrame</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestAggregateDataFrame</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_aggregate_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="s1">&#39;prop a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">],</span>
                             <span class="s1">&#39;prop b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span> <span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;q&#39;</span><span class="p">]})</span>
        <span class="n">group_by_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample_id&#39;</span><span class="p">,</span><span class="s1">&#39;prop a&#39;</span><span class="p">]</span>
        <span class="n">aggregation_functions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="s1">&#39;prop a&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;s3&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;s2&#39;</span><span class="p">},</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}})</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">groupby_columns</span><span class="o">=</span><span class="n">group_by_columns</span><span class="p">,</span> <span class="n">aggregation_functions</span><span class="o">=</span><span class="n">aggregation_functions</span><span class="p">)</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestAggregateDataFrame</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_aggregate_dataframe (__main__.TestAggregateDataFrame) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.007s

OK
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="calculating-rate-per-unit">
<h3>Calculating rate per unit<a class="headerlink" href="#calculating-rate-per-unit" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.calculate_rate_per_unit</span></code></p></li>
</ul>
<div class="section" id="id2">
<h4>config settings<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<p>Accepts the following arguments for the methods, the default is <code class="docutils literal notranslate"><span class="pre">setvariables.unit_agg</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">setvariables.agg_groups</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setvariables.unit_agg</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestCalculateRatePerUnit</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_calculate_rate_per_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">})</span>

        <span class="c1"># Objects to check</span>
        <span class="n">column_of_interest</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span>
        <span class="n">objects_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
        <span class="n">groupby_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
        
        <span class="c1"># Aggregation functions</span>
        <span class="n">aggregation_methods</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span>
        <span class="p">}</span>
        
        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">130</span><span class="p">},</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">}})</span>
        
        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">calculate_rate_per_unit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">objects_to_check</span><span class="p">,</span><span class="n">column_of_interest</span><span class="o">=</span><span class="n">column_of_interest</span><span class="p">,</span> <span class="n">groupby_columns</span><span class="o">=</span><span class="n">groupby_columns</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestCalculateRatePerUnit</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestCalculateRatePerUnit</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_calculate_rate_per_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Sample data</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="s1">&#39;object&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="p">})</span>

        <span class="c1"># Objects to check</span>
        <span class="n">column_of_interest</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span>
        <span class="n">objects_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
        <span class="n">groupby_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">]</span>
        
        <span class="c1"># Aggregation functions</span>
        <span class="n">aggregation_methods</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span>
        <span class="p">}</span>
        
        <span class="c1"># Expected result</span>
        <span class="n">expected_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            
            <span class="s1">&#39;pcs_m&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">},</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">130</span><span class="p">},</span>
            <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">}})</span>
        
        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">calculate_rate_per_unit</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">objects_to_check</span><span class="p">,</span><span class="n">column_of_interest</span><span class="o">=</span><span class="n">column_of_interest</span><span class="p">,</span> <span class="n">groupby_columns</span><span class="o">=</span><span class="n">groupby_columns</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestCalculateRatePerUnit</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_calculate_rate_per_unit (__main__.TestCalculateRatePerUnit) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.005s

OK
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="aggregate-boundaries">
<h3>Aggregate boundaries<a class="headerlink" href="#aggregate-boundaries" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.aggregate_boundaries</span></code></p></li>
</ul>
<p>Is called by <code class="docutils literal notranslate"><span class="pre">reportclass.a_cumulative_report</span></code> and calls <code class="docutils literal notranslate"><span class="pre">reportclass.aggregate_dataframe</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">TestAggregateBoundaries</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># from user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span> <span class="o">=</span> <span class="s1">&#39;Objects&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>

        <span class="c1"># from default or user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># the feature name, sample id and object columns make up the groupby columns</span>
        <span class="c1"># the feauture name is used to mask the different child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>

        <span class="c1"># the labels of the child boundaries are collected</span>
        <span class="c1"># using the feature name variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># the boundary columns are used when aggregating the child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">test_aggregate_boundaries_without_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;groupby_columns&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;boundary_labels&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;boundary_columns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span><span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">},</span>
             <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
             <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">},</span>
             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">}</span>
            <span class="p">})</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_aggregate_boundaries_with_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;groupby_columns&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;boundary_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span><span class="p">,</span>
            <span class="s1">&#39;boundary_columns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span><span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">],</span>
             <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">],</span>
             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">]</span>
            <span class="p">})</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestAggregateBoundaries</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># from user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span> <span class="o">=</span> <span class="s1">&#39;Objects&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>

        <span class="c1"># from default or user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># the feature name, sample id and object columns make up the groupby columns</span>
        <span class="c1"># the feauture name is used to mask the different child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>

        <span class="c1"># the labels of the child boundaries are collected</span>
        <span class="c1"># using the feature name variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># the boundary columns are used when aggregating the child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">test_aggregate_boundaries_without_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;groupby_columns&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;boundary_labels&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;boundary_columns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span><span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">},</span>
             <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
             <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">},</span>
             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">}</span>
            <span class="p">})</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_aggregate_boundaries_with_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;groupby_columns&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;boundary_labels&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span><span class="p">,</span>
            <span class="s1">&#39;boundary_columns&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span><span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">],</span>
             <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
             <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">],</span>
             <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">]</span>
            <span class="p">})</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">aggregate_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestAggregateBoundaries</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_aggregate_boundaries_with_labels (__main__.TestAggregateBoundaries) ... ok
test_aggregate_boundaries_without_labels (__main__.TestAggregateBoundaries) ... ok

----------------------------------------------------------------------
Ran 2 tests in 0.017s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cumulative-reports">
<h3>Cumulative reports<a class="headerlink" href="#cumulative-reports" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>reportclass.a_cumulative_report</p></li>
</ul>
<p>Calls <code class="docutils literal notranslate"><span class="pre">reportclass.aggregate_boundaries</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">TestAcumulativeReport</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># from user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span> <span class="o">=</span> <span class="s1">&#39;Objects&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>

        <span class="c1"># from default or user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># the feature name, sample id and object columns make up the groupby columns</span>
        <span class="c1"># the feauture name is used to mask the different child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>

        <span class="c1"># the labels of the child boundaries are collected</span>
        <span class="c1"># using the feature name variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># the boundary columns are used when aggregating the child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">test_acumulative_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;feature_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span>
            <span class="s1">&#39;object_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">,</span>
            <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;pivot_values&#39;</span><span class="p">:</span> <span class="s1">&#39;Density&#39;</span>
          <span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2019</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">},</span>
            <span class="mi">2020</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">},</span>
            <span class="mi">2021</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">60.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">50.0</span><span class="p">},</span>
            <span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">}}</span>
        <span class="p">)</span>
        <span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span>
        <span class="n">expected</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;label&#39;</span>        
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">a_cumulative_report</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
      
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestAcumulativeReport</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestAcumulativeReport</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        
        <span class="c1"># from user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span> <span class="o">=</span> <span class="s1">&#39;Objects&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>

        <span class="c1"># from default or user input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="s1">&#39;median&#39;</span><span class="p">}</span>

        <span class="c1"># the feature name, sample id and object columns make up the groupby columns</span>
        <span class="c1"># the feauture name is used to mask the different child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupby_columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>

        <span class="c1"># the labels of the child boundaries are collected</span>
        <span class="c1"># using the feature name variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

        <span class="c1"># the boundary columns are used when aggregating the child boundaries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boundary_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">test_acumulative_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;feature_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature_name</span><span class="p">,</span>
            <span class="s1">&#39;object_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span><span class="p">,</span>
            <span class="s1">&#39;sample_id&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span>
            <span class="s1">&#39;unit_agg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_methods</span><span class="p">,</span>
            <span class="s1">&#39;group_agg&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">group_methods</span><span class="p">,</span>
            <span class="s1">&#39;pivot_values&#39;</span><span class="p">:</span> <span class="s1">&#39;Density&#39;</span>
          <span class="p">}</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span><span class="mi">2019</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">},</span>
            <span class="mi">2020</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">},</span>
            <span class="mi">2021</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">60.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">50.0</span><span class="p">},</span>
            <span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">40.0</span><span class="p">}}</span>
        <span class="p">)</span>
        <span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_column</span>
        <span class="n">expected</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;label&#39;</span>        
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">a_cumulative_report</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
      
        <span class="c1"># Check if the result matches the expected result</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestAcumulativeReport</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_acumulative_df (__main__.TestAcumulativeReport) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.019s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="categorize-work-data">
<h3>Categorize work data<a class="headerlink" href="#categorize-work-data" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.categorize_work_data</span></code></p></li>
</ul>
<p>Called by <code class="docutils literal notranslate"><span class="pre">reportclass.ReportClass</span></code></p>
<blockquote>
<div><p>Generates <code class="docutils literal notranslate"><span class="pre">ReportClass.features</span></code></p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestCategorizeWorkData</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># these values are set in the conf file. They describe the oreder of</span>
        <span class="c1"># aggregation. The lowest reporting unit is last, in this case city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">,</span>  <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">]</span>
        
       
    <span class="k">def</span> <span class="nf">test_categorize_work_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="c1"># Expected output</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2021</span><span class="p">]),</span>
                <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
            <span class="p">}}</span>
        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">categorize_work_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">akey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span><span class="p">:</span>
            <span class="n">done</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">akey</span><span class="p">])</span>
            <span class="n">dtwo</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">akey</span><span class="p">])</span>
            <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="n">done</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="n">dtwo</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestCategorizeWorkData</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">})</span>
        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># these values are set in the conf file. They describe the oreder of</span>
        <span class="c1"># aggregation. The lowest reporting unit is last, in this case city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">,</span>  <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Use&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">]</span>
        
       
    <span class="k">def</span> <span class="nf">test_categorize_work_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       
        <span class="c1"># Expected output</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;l&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span> <span class="s1">&#39;object&#39;</span><span class="p">),</span>
                <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2021</span><span class="p">]),</span>
                <span class="s1">&#39;samples&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
            <span class="p">}}</span>
        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">categorize_work_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">akey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span><span class="p">:</span>
            <span class="n">done</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">akey</span><span class="p">])</span>
            <span class="n">dtwo</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">akey</span><span class="p">])</span>
            <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="n">done</span><span class="p">,</span> <span class="n">second</span><span class="o">=</span><span class="n">dtwo</span><span class="p">)</span>


<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestCategorizeWorkData</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_categorize_work_data (__main__.TestCategorizeWorkData) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.004s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="summarize-a-vector">
<h3>Summarize a vector<a class="headerlink" href="#summarize-a-vector" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a_summary_of_one_vector</span></code></p></li>
</ul>
<p>Called by <code class="docutils literal notranslate"><span class="pre">reportclass.ReportClass.summarize_feature_labels</span></code> and calls <code class="docutils literal notranslate"><span class="pre">aggregate_dataframe</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">TestASummaryOfOneVector</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Slug&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l5&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l3&#39;</span><span class="p">,</span> <span class="s1">&#39;l4&#39;</span><span class="p">,</span> <span class="s1">&#39;l4&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>        

        <span class="c1"># these values are set in the conf file. They describe the oreder of</span>
        <span class="c1"># aggregation. The lowest reporting unit is last, in this case city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">,</span>  <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;City&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_a_summary_of_one_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Test the case of one vector</span>
        <span class="n">test_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Use</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">]</span>
        <span class="n">unit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample id&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">]</span>
        <span class="n">unit_agg</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lake&#39;</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">a_summary_of_one_vector</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="n">unit_columns</span><span class="p">,</span> <span class="n">unit_agg</span><span class="p">,</span> <span class="n">describe</span><span class="o">=</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">total_column</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">)</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>        

    <span class="k">def</span> <span class="nf">test_summarize_feature_variables_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># this can be set in config or called as a</span>
        <span class="c1"># keyword variable</span>
        <span class="n">unit_agg</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>

        <span class="c1"># summaruze features is a method in the ReportClass</span>
        <span class="c1"># that calls a_summary_of_one_vector on collections</span>
        <span class="c1"># of vectors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">summarize_feature_labels_test</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Slug&#39;</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">,</span> <span class="n">unit_agg</span><span class="o">=</span><span class="n">unit_agg</span><span class="p">,</span> <span class="n">describe_column</span><span class="o">=</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">total_column</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">)</span>
        

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">):</span> <span class="p">{</span>
            <span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
        
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">summarize_feature_labels_test</span><span class="p">(</span><span class="n">df</span><span class="p">,</span>
                             <span class="n">feature</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                             <span class="n">sample_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;loc_date&#39;</span><span class="p">,</span>
                             <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;slug&#39;</span><span class="p">,</span>
                             <span class="n">describe_column</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;pcs_m&#39;</span><span class="p">,</span>
                             <span class="n">unit_agg</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">conf_</span><span class="o">.</span><span class="n">unit_agg</span><span class="p">,</span>
                             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    
    <span class="n">unit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">sample_id</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">feature</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">the_label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">the_label</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">a_summary_of_one_vector</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
                                     <span class="n">unit_columns</span><span class="o">=</span><span class="n">unit_columns</span><span class="p">,</span>
                                     <span class="n">unit_agg</span><span class="o">=</span><span class="n">unit_agg</span><span class="p">,</span>
                                     <span class="n">describe</span><span class="o">=</span><span class="n">describe_column</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">the_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;NaN&#39;</span><span class="p">)</span>
 
    
    <span class="k">return</span> <span class="n">d</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
    
<span class="k">class</span> <span class="nc">TestASummaryOfOneVector</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame for testing</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Use&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">2019</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2021</span><span class="p">],</span>
            <span class="s1">&#39;State&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;City&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Slug&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="s1">&#39;l5&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l3&#39;</span><span class="p">,</span> <span class="s1">&#39;l4&#39;</span><span class="p">,</span> <span class="s1">&#39;l4&#39;</span><span class="p">],</span>
            <span class="s1">&#39;sample id&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="s1">&#39;Objects&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="p">})</span>

        <span class="c1"># test data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        

        <span class="c1"># these values are set in the conf file. They describe the oreder of</span>
        <span class="c1"># aggregation. The lowest reporting unit is last, in this case city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">,</span>  <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span> <span class="o">=</span> <span class="s1">&#39;sample id&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature</span> <span class="o">=</span> <span class="s1">&#39;City&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">test_a_summary_of_one_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Test the case of one vector</span>
        <span class="n">test_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">Use</span> <span class="o">==</span> <span class="s1">&#39;l&#39;</span><span class="p">]</span>
        <span class="n">unit_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sample id&#39;</span><span class="p">,</span> <span class="s1">&#39;Slug&#39;</span><span class="p">,</span> <span class="s1">&#39;Use&#39;</span><span class="p">]</span>
        <span class="n">unit_agg</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>
        <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Lake&#39;</span>
        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">a_summary_of_one_vector</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="n">unit_columns</span><span class="p">,</span> <span class="n">unit_agg</span><span class="p">,</span> <span class="n">describe</span><span class="o">=</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">total_column</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">)</span>

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
            <span class="s1">&#39;Density&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}})</span>
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">to_dict</span><span class="p">())</span>
        <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        
      
        

    <span class="k">def</span> <span class="nf">test_summarize_feature_variables_test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># this can be set in config or called as a</span>
        <span class="c1"># keyword variable</span>
        <span class="n">unit_agg</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Density&#39;</span><span class="p">:</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span><span class="s1">&#39;sum&#39;</span><span class="p">}</span>

        <span class="c1"># summaruze features is a method in the ReportClass</span>
        <span class="c1"># that calls a_summary_of_one_vector on collections</span>
        <span class="c1"># of vectors</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">summarize_feature_labels_test</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">sample_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_id</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;Slug&#39;</span><span class="p">,</span> <span class="n">feature</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">feature</span><span class="p">,</span> <span class="n">unit_agg</span><span class="o">=</span><span class="n">unit_agg</span><span class="p">,</span> <span class="n">describe_column</span><span class="o">=</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">total_column</span><span class="o">=</span><span class="s1">&#39;Quantity&#39;</span><span class="p">)</span>
        

        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">):</span> <span class="p">{</span>
            <span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;b1&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
            <span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s1">&#39;25%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;50%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;75%&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
            <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="s1">&#39;NaN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
        
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">set</span><span class="p">(</span><span class="n">expected</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        
        
      
        

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestASummaryOfOneVector</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_a_summary_of_one_vector (__main__.TestASummaryOfOneVector) ... ok
test_summarize_feature_variables_test (__main__.TestASummaryOfOneVector) ... ok

----------------------------------------------------------------------
Ran 2 tests in 0.061s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="collecting-records-by-value">
<h3>Collecting records by value<a class="headerlink" href="#collecting-records-by-value" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reportclass.get_top_x_records_with_max_quantity</span></code></p></li>
</ul>
<p>Is called by <code class="docutils literal notranslate"><span class="pre">reportclass.ReportClass.inventory</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestGetTopXRecordsWithMaxQuantity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_get_top_x_records_with_max_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># the column used to measure</span>
        <span class="n">quantity_column</span> <span class="o">=</span> <span class="s1">&#39;Quantity&#39;</span>
        <span class="c1"># the id of the objects being measured</span>
        <span class="n">id_column</span> <span class="o">=</span> <span class="s1">&#39;ID&#39;</span>
        <span class="c1"># get the top 3</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="c1"># test that</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">get_top_x_records_with_max_quantity</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">quantity_column</span><span class="p">,</span> <span class="n">id_column</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="c1"># expected output</span>
        <span class="n">expected_d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="s1">&#39;%&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.46153846153846156</span><span class="p">,</span> <span class="mf">0.3076923076923077</span><span class="p">,</span> <span class="mf">0.23076923076923078</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">expected_d</span><span class="p">)</span>

        <span class="c1"># test result against expected</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">expected</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestGetTopXRecordsWithMaxQuantity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_get_top_x_records_with_max_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># the column used to measure</span>
        <span class="n">quantity_column</span> <span class="o">=</span> <span class="s1">&#39;Quantity&#39;</span>
        <span class="c1"># the id of the objects being measured</span>
        <span class="n">id_column</span> <span class="o">=</span> <span class="s1">&#39;ID&#39;</span>
        <span class="c1"># get the top 3</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

        <span class="c1"># test that</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">get_top_x_records_with_max_quantity</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">quantity_column</span><span class="p">,</span> <span class="n">id_column</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="c1"># expected output</span>
        <span class="n">expected_d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
            <span class="s1">&#39;Quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
            <span class="s1">&#39;%&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.46153846153846156</span><span class="p">,</span> <span class="mf">0.3076923076923077</span><span class="p">,</span> <span class="mf">0.23076923076923078</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">expected_d</span><span class="p">)</span>

        <span class="c1"># test result against expected</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">expected</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestGetTopXRecordsWithMaxQuantity</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_get_top_x_records_with_max_quantity (__main__.TestGetTopXRecordsWithMaxQuantity) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.006s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="counting-occurences">
<h3>Counting occurences<a class="headerlink" href="#counting-occurences" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>reportclass.count_objects_with_positive_quantity</p></li>
</ul>
<p>Is called by <code class="docutils literal notranslate"><span class="pre">reportclass.ReportClass.inventory</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestCountObjectsWithPositiveQuantity</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_count_objects_with_positive_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a sample DataFrame</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;sample&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="s1">&#39;s3&#39;</span><span class="p">],</span>
            <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Define the parameters for the function</span>
        <span class="n">value_column</span> <span class="o">=</span> <span class="s1">&#39;quantity&#39;</span>
        <span class="n">object_column</span> <span class="o">=</span> <span class="s1">&#39;code&#39;</span>

        <span class="c1"># Call the function</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">count_objects_with_positive_quantity</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">value_column</span><span class="p">,</span> <span class="n">object_column</span><span class="p">)</span>

        <span class="c1"># Define the expected output</span>
        <span class="n">expected_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
        <span class="n">expected_output</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">expected_data</span><span class="p">)</span>

        <span class="c1"># Check if the result matches the expected output</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_series_equal</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(),</span> <span class="n">expected_output</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestGetTopXRecordsWithMaxQuantity</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_get_top_x_records_with_max_quantity (__main__.TestGetTopXRecordsWithMaxQuantity) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.006s

OK
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="selecting-by-two-criteria">
<h3>Selecting by two criteria<a class="headerlink" href="#selecting-by-two-criteria" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>reportclass.display_tabular_data_by_column_values</p></li>
</ul>
<p>Is called by <code class="docutils literal notranslate"><span class="pre">reportclass.ReportClass.most_common</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestDisplayTabularDataByColumnValues</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_display_tabular_data_by_column_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;index_col&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">],</span>
            <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
            <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

       
        <span class="n">column_one</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;quantity&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
        <span class="n">column_two</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;column2&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
        <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;index_col&#39;</span>

        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">display_tabular_data_by_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_one</span><span class="p">,</span> <span class="n">column_two</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        
        
        <span class="n">expected_d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">expected_d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">])</span>
        
        
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TestDisplayTabularDataByColumnValues</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_display_tabular_data_by_column_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;index_col&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i5&#39;</span><span class="p">],</span>
            <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
            <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

       
        <span class="n">column_one</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;quantity&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
        <span class="n">column_two</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;column2&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">}</span>
        <span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;index_col&#39;</span>

        
        <span class="n">result</span> <span class="o">=</span> <span class="n">r_class</span><span class="o">.</span><span class="n">display_tabular_data_by_column_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_one</span><span class="p">,</span> <span class="n">column_two</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        
        
        <span class="n">expected_d</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;column1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
            <span class="s1">&#39;column2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">45</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span>
            <span class="s1">&#39;quantity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
        <span class="p">}</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">expected_d</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;i5&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">,</span> <span class="s1">&#39;i3&#39;</span><span class="p">])</span>
        
        
        <span class="n">pd</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_frame_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>

<span class="n">test_suite</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">loadTestsFromTestCase</span><span class="p">(</span><span class="n">TestDisplayTabularDataByColumnValues</span><span class="p">)</span>
<span class="n">test_runner</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_result</span> <span class="o">=</span> <span class="n">test_runner</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">test_suite</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test_display_tabular_data_by_column_values (__main__.TestDisplayTabularDataByColumnValues) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.004s

OK
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Region</th>
      <th>Use</th>
      <th>Year</th>
      <th>State</th>
      <th>City</th>
      <th>Slug</th>
      <th>sample id</th>
      <th>Objects</th>
      <th>Density</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>l</td>
      <td>2019</td>
      <td>V</td>
      <td>a1</td>
      <td>l1</td>
      <td>1</td>
      <td>X</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>l</td>
      <td>2019</td>
      <td>B</td>
      <td>a2</td>
      <td>l5</td>
      <td>5</td>
      <td>Y</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>B</td>
      <td>p</td>
      <td>2020</td>
      <td>V</td>
      <td>b1</td>
      <td>l2</td>
      <td>2</td>
      <td>X</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>p</td>
      <td>2020</td>
      <td>V</td>
      <td>b1</td>
      <td>l2</td>
      <td>2</td>
      <td>Y</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A</td>
      <td>r</td>
      <td>2021</td>
      <td>B</td>
      <td>a2</td>
      <td>l3</td>
      <td>3</td>
      <td>Y</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>B</td>
      <td>l</td>
      <td>2021</td>
      <td>C</td>
      <td>b2</td>
      <td>l4</td>
      <td>4</td>
      <td>X</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C</td>
      <td>l</td>
      <td>2021</td>
      <td>B</td>
      <td>a2</td>
      <td>l4</td>
      <td>4</td>
      <td>X</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Author: hammerdirt-analyst

conda environment: cantonal_report

numpy     : 1.25.2
matplotlib: 3.7.1
pandas    : 2.0.3
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="cumulative_reports.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cumulative reports</p>
      </div>
    </a>
    <a class="right-next"
       href="landuse_class.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Land use class</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requests">Requests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#report-boundaries">Report boundaries</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#report-contents">Report contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#report-labels">Report labels</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generating-a-report-for-a-specific-feature">Generating a report for a specific feature</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-survey-totals-between-features">Comparing survey totals between features</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#most-common-objects">Most common objects</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#works-the-same-for-a-subreport">Works the same for a subreport</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-criteria-of-the-most-common">Changing the criteria of the most common</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieving-properties">Retrieving properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-tests">Unit tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-reportclass-module">The reportclass module</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-reportclass-takes-the-following-parameters">The <code class="docutils literal notranslate"><span class="pre">ReportClass</span></code> takes the following parameters:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#and-has-the-following-methods">And has the following methods:</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-methods-in-the-reportclass-module">Other methods in the <code class="docutils literal notranslate"><span class="pre">reportclass</span></code> module.</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-codes-using-parent-groups">Combining codes using parent groups</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#specific-to-beach-litter-data">Specific to beach litter data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-a-dataframe">Aggregate a dataframe</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#config-settings">config settings</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-rate-per-unit">Calculating rate per unit</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">config settings</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-boundaries">Aggregate boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cumulative-reports">Cumulative reports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorize-work-data">Categorize work data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-a-vector">Summarize a vector</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#collecting-records-by-value">Collecting records by value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#counting-occurences">Counting occurences</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-by-two-criteria">Selecting by two criteria</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By team@
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
   hammerdirt 2023
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>